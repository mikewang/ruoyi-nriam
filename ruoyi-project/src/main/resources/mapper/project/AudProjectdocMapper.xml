<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ruoyi.project.mapper.AudProjectdocMapper">
  <resultMap id="BaseResultMap" type="com.ruoyi.project.domain.AudProjectdoc">
    <result column="ProjectID" jdbcType="INTEGER" property="projectid" />
    <result column="DocID" jdbcType="INTEGER" property="docid" />
    <result column="DocType" jdbcType="VARCHAR" property="doctype" />
    <result column="IfDeleted" jdbcType="BIT" property="ifdeleted" />
    <result column="DocName" jdbcType="VARCHAR" property="docname" />
    <result column="RelativePath" jdbcType="VARCHAR" property="relativepath" />
  </resultMap>

  <sql id="selectAudProjectDoc">
    SELECT a.ProjectID      ,a.DocID      ,a.DocType      ,a.IfDeleted, b.DocName,b.RelativePath
    FROM Aud_ProjectDoc a join BAS_Doc b on a.DocID = b.DocID
    where a.IfDeleted=0
  </sql>

  <select id="selectProjectdocList" parameterType="com.ruoyi.project.domain.AudProjectdoc" resultMap="BaseResultMap">
    <include refid="selectAudProjectDoc"/>

    <if test="doctype != null and doctype != '' ">
      and  a.DocType = #{doctype,jdbcType=VARCHAR}
    </if>
    <if test="projectid != null and projectid != 0 ">
      and a.ProjectID = #{projectid, jdbcType=INTEGER}
    </if>

  </select>


  <insert id="insertProjectdoc" parameterType="com.ruoyi.project.domain.AudProjectdoc">
    insert into Aud_ProjectDoc (ProjectID, DocID, DocType,IfDeleted)
    values (#{projectid,jdbcType=INTEGER}, #{docid,jdbcType=INTEGER}, #{doctype,jdbcType=VARCHAR}, 
      #{ifdeleted,jdbcType=BIT})
  </insert>


  <insert id="deleteProjectdoc" parameterType="com.ruoyi.project.domain.AudProjectdoc">
    update  Aud_ProjectDoc
        set IfDeleted =1
        where IfDeleted =0 and DocID = #{docid,jdbcType=INTEGER} and ProjectID = #{projectid,jdbcType=INTEGER}
  </insert>

  <select id="selectAll" resultMap="BaseResultMap">
    select ProjectID, DocID, DocType, IfDeleted
    from Aud_ProjectDoc
  </select>
</mapper>